# Case Report — Windows Endpoint Malware Triage Investigation (Living-Off-the-Land Binary (LoLBin) Abuse and Payload Validation)

**Case Type:** Endpoint Compromise / Malware Infection  
**Primary Abuse Pattern:** Masquerading malware execution leading to credential theft, unauthorized administrative account creation, and establishment of multiple persistence mechanisms using native Windows tooling  
**Status:** Closed (investigation complete)  
**Confidence Level:** High — correlated file artifacts, account changes, scheduled task creation, PowerShell execution, and registry persistence

---

## 1) Executive Summary

This case investigates a Windows endpoint compromise in which multiple executables masquerading as legitimate software were identified and validated as malicious using only native PowerShell tooling. Analysis confirmed execution of credential-stealing malware, unauthorized creation of a new local administrator account, and establishment of persistence through scheduled tasks, PowerShell logon execution, and registry Run key modification.

Static artifact validation identified `omgsoft.exe` as Lumma Stealer based on hash reputation and deceptive version metadata. Execution of `Win_Update.exe` resulted in creation of a new local user (`testuser`) and elevation to the Administrators group, indicating privilege escalation and identity persistence. Additional persistence was confirmed via scheduled task creation and registry startup configuration abusing legitimate Windows binaries.

Evidence supports a post-compromise scenario in which attackers leveraged built-in Windows utilities and trusted binaries (LOLBINs) to evade detection while maintaining access.

---

## 2) Incident Background

The investigation was performed under a constrained response scenario in which only native PowerShell tooling was available, simulating real-world incident response conditions where third-party tools or GUI access may be restricted.

Rather than reverse engineering malware, the objective was rapid endpoint triage and validation of compromise by identifying suspicious artifacts, confirming their legitimacy, assessing impact, and detecting persistence mechanisms using built-in Windows telemetry and configuration state.

The investigation sought to determine:

- Whether suspicious executables were legitimate or malicious  
- Whether execution resulted in system-level changes  
- Whether new users or privilege escalation occurred  
- Whether persistence mechanisms were established  
- Whether trusted binaries were abused to evade detection

---

## 3) Scope

This section defines which systems, identities, and data sources were included in the investigation, as well as what activity was not observed within the available evidence. Clearly defining scope helps distinguish confirmed endpoint compromise from assumptions about broader network intrusion that are not supported by telemetry.

### In-Scope

- **Affected endpoint:** Single Windows host  
- **Primary evidence sources:**
  - File system artifacts and metadata
  - Digital signatures and hashes
  - Local user and group configuration
  - Scheduled task configuration
  - Registry Run key startup entries
  - PowerShell execution behavior
- **Behavioral focus areas:**
  - Masquerading executables
  - Privilege escalation via account creation
  - Persistence via tasks and registry
  - LOLBIN abuse

### Out-of-Scope / Not Observed

- Network traffic analysis
- Memory analysis
- Malware reverse engineering
- Lateral movement to additional hosts

Conclusions are based solely on host-level artifacts observable through native Windows tooling.

---

## 4) Environment

This investigation validated malware execution, privilege escalation, and persistence using only native Windows tooling.

**Affected System (Victim) Operating System:**
- Windows workstation

**Analyst Virtual Machine Operating System:**
- Windows-based analyst workstation performing live-response activities

**Platforms and Services:**
- Windows Task Scheduler — analyzed persistence via scheduled tasks
- Windows registry startup mechanisms — reviewed autorun entries
- PowerShell — used to enumerate files, users, and system configuration

**Data Sources Reviewed:**
- File system artifacts and metadata
- Authenticode digital signature validation
- Local user and group configuration
- Scheduled task configuration
- Registry Run key startup entries
- PowerShell execution behavior

**Analyst Note:**  
The investigation simulates constrained incident response conditions where only built-in operating system tooling is available.

---

## 5) Evidence Summary

This section summarizes the primary evidence used to reconstruct malware execution, privilege escalation, and persistence activity observed during this incident. It focuses on how each data source contributed to understanding attacker behavior and impact rather than listing all raw fields or command output.

Detailed artifact values, command output, and detection-relevant indicators extracted from this investigation are documented separately in: `detection-artifact-report.md`

This separation reflects common SOC workflows, where incident narratives and detection engineering references are maintained as distinct artifacts.


### 5.1 Malware Validation — Masquerading Executable (omgsoft.exe)

File metadata and hash analysis confirmed that `omgsoft.exe` falsely identified itself as legitimate CCleaner software through manipulated version information while being located in a non-standard user directory.

Reputation analysis using the SHA-256 hash identified the file as belonging to the **Lumma Stealer** malware family, confirming credential-stealing capability and validating malicious intent.

This demonstrates masquerading behavior, where attackers use trusted software branding to evade user suspicion.


### 5.2 Untrusted Installer Identification — neuro.msi

Digital signature validation showed that `neuro.msi` was unsigned, indicating it was not issued by a trusted publisher.

Unsigned MSI installers are commonly abused to deliver malware payloads and bypass trust-based execution controls, supporting the conclusion that this artifact was part of the infection chain rather than legitimate software.


### 5.3 Privilege Escalation — Unauthorized Account Creation

Execution of `Win_Update.exe` resulted in creation of a new local user account:

- **Created account:** `testuser`

Post-execution enumeration of local groups confirmed that `testuser` was added to the **Administrators** group, granting full system privileges.

Legitimate update mechanisms do not modify local user accounts or administrator group membership, confirming that execution of the binary resulted in malicious system modification.


### 5.4 Persistence Mechanism — Scheduled Task Creation

Scheduled task enumeration revealed creation of a non-standard task:

- **Task name:** `LoginProcessDump`

The task was configured to execute PowerShell at user logon, providing repeated execution without user interaction.

Scheduled tasks are commonly abused for persistence due to their reliability and ability to operate silently.


### 5.5 Logon Execution — PowerShell Abuse

Inspection of scheduled task actions revealed execution of:

`powershell.exe -NoProfile -WindowStyle Hidden -Command "Get-Process | Out-File C:\processes.txt"`

This command executes silently and performs reconnaissance by enumerating running processes, indicating post-compromise situational awareness by the attacker.

Use of hidden PowerShell execution strongly indicates malicious automation rather than administrative scripting.


### 5.6 Registry-Based Startup Persistence — LOLBIN Abuse

Registry Run key inspection revealed a startup entry configured as:

- **Registry Path:** `HKCU:\Software\Microsoft\Windows\CurrentVersion\Run`  
- **Value Name:** `MaliciousApp`  
- **Executable:** `C:\Windows\System32\notepad.exe`

Although `notepad.exe` is legitimate, it is not intended to run automatically at logon. Abuse of trusted Windows binaries for persistence is consistent with Living-off-the-Land Binary (LOLBIN) techniques designed to evade detection.

---

## 6) Investigation Timeline (Condensed)

The timeline below reflects the reconstructed sequence of attacker and host activity, not the step-by-step actions taken by the analyst during investigation. Detailed analyst workflow and command execution are documented separately in: `investigation-walkthrough.md`

| Phase | Activity |
|--------|--------|
| T0 | Suspicious executables discovered in user directory |
| T1 | Hash and metadata confirm masquerading malware |
| T2 | Unsigned installer identified |
| T3 | Execution of malicious binary creates admin user |
| T4 | Scheduled task established for persistence |
| T5 | PowerShell configured for silent logon execution |
| T6 | Registry Run key modified to abuse trusted binary |

---

## 7) Indicators of Compromise (IOCs)

The indicators listed below represent high-confidence artifacts associated with malware execution, privilege escalation, and persistence observed during this intrusion.

Field-level telemetry, registry paths, and detection logic derived from these indicators are documented separately in: `detection-artifact-report.md`

That report is intended for SOC analysts and detection engineers responsible for implementing monitoring and alerting controls.


### 7.1 File-Based IOCs

These indicators identify malicious or suspicious binaries associated with the infection chain.

- `omgsoft.exe` (Lumma Stealer)  
- `neuro.msi` (unsigned installer)  
- `Win_Update.exe` (malware masquerading as update)

**Detection Use Cases:**
- Alert on unsigned executables in user directories
- Detect masquerading file names resembling updates or installers


### 7.2 Identity & Privilege IOCs

These indicators reflect unauthorized identity creation and privilege escalation.

- New local user: `testuser`  
- Group membership: `testuser` added to `Administrators`

**Detection Use Cases:**
- Alert on new local user creation
- Detect changes to local administrator group membership


### 7.3 Persistence Mechanism IOCs

These indicators reflect long-term execution mechanisms.

- Scheduled task: `LoginProcessDump`  
- Registry Run key: `HKCU:\...\Run → MaliciousApp → notepad.exe`

**Detection Use Cases:**
- Monitor for non-baseline scheduled tasks
- Detect registry startup entries pointing to LOLBINs


### 7.4 PowerShell Execution IOCs

These indicators reflect post-compromise automation and reconnaissance.

- Hidden PowerShell execution  
- `-NoProfile` and `-WindowStyle Hidden` flags  
- Process enumeration written to disk

**Detection Use Cases:**
- Alert on PowerShell launched with hidden window flags
- Monitor scheduled tasks invoking scripting engines


### 7.5 IOC Limitations

While the indicators above are high-confidence within this investigation, attackers can easily change file names, scheduled task identifiers, and registry value names. As a result, detection strategies should prioritize behavioral correlations such as privilege escalation followed by persistence establishment rather than relying solely on static artifact names.

---

## 8) Case Determination

**Final Determination:**  
Confirmed Windows endpoint compromise involving execution of credential-stealing malware, unauthorized creation of administrative user accounts, and establishment of multiple persistence mechanisms using native Windows tooling and trusted binaries.

Evidence supports a living-off-the-land intrusion pattern designed to evade signature-based detection while maintaining durable access to the host.

---

## 9) Recommended Follow-Ups (Case Closure Actions)

The recommendations below summarize key containment, hardening, and detection priorities based on behaviors observed during this incident. Detailed technical controls and expanded monitoring strategies are documented separately in: `detection-and-hardening-recommendations.md`

This section highlights immediate and high-impact actions, while the supporting report provides implementation-level detail.

### Immediate Containment

- Isolate the affected endpoint  
- Remove unauthorized local user accounts  
- Terminate malicious scheduled tasks and registry entries  
- Preserve artifacts for forensic review

### Hardening

- Restrict execution from user-writable directories  
- Enforce application allowlisting  
- Monitor and protect administrative group membership

### Detection

- Alert on local account creation events  
- Detect scheduled tasks created outside baselines  
- Monitor registry Run key modifications involving LOLBINs

---

## 10) Supporting Reports (In This Folder)

The files below make up the full case package for this investigation and provide additional detail across analyst workflow, response actions, detection engineering, and executive-level reporting.

- `investigation-walkthrough.md` — Step-by-step analyst workflow and screenshots  
- `incident-summary.md` — Executive-level narrative and business impact  
- `incident-response-report.md` — Containment and recovery actions  
- `detection-artifact-report.md` — Detection-relevant artifacts and telemetry  
- `detection-and-hardening-recommendations.md` — Preventive controls and monitoring improvements  
- `MITRE-ATTACK-mapping.md` — Detailed technique mapping with evidence references  
- `images/` — Screenshots and visual evidence  
- `README.md` — High-level investigation overview

---

## 11) MITRE ATT&CK Mapping

The mappings below provide a high-level summary of confirmed adversary behaviors observed during this incident.

- Full investigative context and evidence references: `investigation-walkthrough.md`  
- Expanded technique analysis and detection considerations: `MITRE-ATTACK-mapping.md`

### Technique Mapping

- **Execution — PowerShell (T1059.001)**
- **Persistence — Scheduled Task (T1053.005)**
- **Persistence — Registry Run Keys/Startup Folder (T1547.001)**
- **Defense Evasion — Masquerading (T1036)**
- **Credential Access — Credentials from Web Browsers (T1555.003)**

### MITRE ATT&CK Mapping (Table View)

| Tactic | Technique | Description |
|--------|----------|-------------|
| Execution | **PowerShell (T1059.001)** | Hidden PowerShell execution used for post-compromise reconnaissance and automation. |
| Persistence | **Scheduled Task (T1053.005)** | Scheduled task (`LoginProcessDump`) created to trigger execution at user logon. |
| Persistence | **Registry Run Keys/Startup Folder (T1547.001)** | Registry Run key modified to execute trusted binary at logon. |
| Defense Evasion | **Masquerading (T1036)** | Malware disguised as legitimate software updates and installers. |
| Credential Access | **Credentials from Web Browsers (T1555.003)** | Lumma Stealer infection indicates harvesting of stored browser credentials. |

---
