# Detection Artifact Report — Windows Endpoint Malware Triage Investigation (Living-Off-the-Land Binary (LoLBin) Abuse and Payload Validation)

### 1) Purpose and Scope

This report documents **host-based malware indicators and validation artifacts** observed during investigation of suspicious activity on a Windows endpoint, where an unknown executable was identified, analyzed, and validated as malicious using host telemetry and external reputation services.

The purpose of this report is to provide **detection-engineering–ready artifacts that are explicitly tied to analyst investigation pivots**, demonstrating how raw endpoint alerts were transformed into confirmed malware findings through systematic validation.

Artifacts are mapped to how they were discovered during investigation, reflecting real SOC workflows where analysts pivot between:

- process telemetry,
- file system activity,
- hash reputation services,
- and behavioral execution patterns.

All artifacts are derived from investigative steps documented in:

- `windows-endpoint-malware-triage-and-validation-investigation.md` — analyst pivots, Splunk queries, and validation workflow  
- `case-report.md` — reconstructed attacker activity and impact assessment  
- `MITRE-ATT&CK-mapping.md` — technique classification and behavioral context  

This report complements:

- `incident-response-report.md` — containment and remediation sequencing  
- `detection-and-hardening-recommendations.md` — long-term preventive and monitoring controls  

---

### 2) Environment and Log Sources

This section summarizes telemetry sources used to identify and validate malware artifacts.

#### ▶ 2.1) Primary telemetry sources referenced in investigation

- **Sysmon (Microsoft Sysinternals)**
  - Event ID 1 — Process creation
  - Event ID 11 — File creation
  - Event ID 3 — Network connections (if present)

- **Windows Security Event Log**
  - Event ID 4688 — Process creation
  - Event ID 4624 — Successful logon

- **Splunk Endpoint Data Models**
  - Endpoint.Processes
  - Endpoint.Filesystem
  - Endpoint.Network

- **External Threat Intelligence**
  - VirusTotal hash reputation and behavioral classification

#### ▶ 2.2) Confirmed host

- **Victim system:** Windows workstation (lab host)  
- **User context:** Logged-in interactive user session

---

### 3) High-Confidence Investigation Anchors

This section documents timeline anchors that structured investigative correlation.

| Anchor Event | Description | Evidence Source | Investigation Pivot |
|--------|-------------|------------------|---------------------|
| Initial alert | Suspicious process execution | SIEM query | Triggered host triage |
| Unknown binary | Non-standard executable observed | Sysmon Event ID 1 | Led to file validation |
| File origin | Executable newly created on disk | Sysmon Event ID 11 | Confirmed payload staging |
| Hash analysis | File hash submitted to VirusTotal | External TI | Validated malware |
| Continued execution | Repeated process launches | Sysmon Event ID 1 | Confirmed active infection |

These anchors guided pivoting from execution to file validation and reputation assessment.

---

### 4) Initial Suspicious Process Detection Artifacts

This section documents the first indicators that triggered malware triage.

#### ▶ 4.1) Artifact: Execution of Unknown or Rare Binary

**Observed Behavior:**

- Process creation event for executable not associated with installed software.
- File name and path inconsistent with standard applications.

**Where Identified in Investigation:**  
Analysts began by reviewing SIEM process telemetry highlighting rare or unfamiliar executables. From this alert, they pivoted into Sysmon Event ID 1 logs using Splunk to reconstruct the full process tree and identify the parent process responsible for launching the binary, confirming that execution did not originate from legitimate installers or system services.

**Behavioral Significance:**

- Indicates possible malware execution or unauthorized software.
- Justifies deeper file and reputation analysis.

**Detection Guidance:**

- Alert when:
  - rare executables appear on endpoints
- Correlate with:
  - recent file creation events

---

### 5) File System and Payload Staging Artifacts

This section documents how the malicious binary was delivered and staged.

#### ▶ 5.1) Artifact: Recent File Creation of Executed Binary

**Observed Behavior:**

- Executed file was created shortly before first execution.

**Where Identified in Investigation:**  
After confirming abnormal execution, analysts pivoted to Sysmon Event ID 11 around the execution timestamp to determine file origin. This showed that the executable had been written to disk minutes before being launched, supporting hypothesis of payload delivery rather than dormant software already present on the host.

**Behavioral Significance:**

- Confirms payload staging behavior.
- Links file creation directly to execution.

**Detection Guidance:**

- Alert when:
  - executables are created in user-writable directories
- Correlate with:
  - immediate subsequent execution

---

### 6) Malware Validation and Reputation Artifacts

This section documents how malware classification was confirmed.

#### ▶ 6.1) Artifact: Malicious Hash Classification via VirusTotal

**Observed Behavior:**

- File hash flagged by multiple antivirus engines as malicious.

**Where Identified in Investigation:**  
Once the file was isolated, analysts extracted the cryptographic hash from file system telemetry and manually submitted it to VirusTotal. Results showed high-confidence malicious classification across multiple vendors, confirming that the binary represented known malware rather than benign software.

**Behavioral Significance:**

- Confirms true positive detection.
- Supports escalation to incident response rather than software policy enforcement.

**Detection Guidance:**

- Enrich detections with:
  - threat intelligence hash reputation
- Auto-escalate when:
  - multiple engines classify file as malicious


#### ▶ 6.2) Artifact: Malware Family and Behavioral Classification

**Observed Behavior:**

- VirusTotal provided malware family or behavioral category indicators.

**Where Identified in Investigation:**  
During threat intelligence review, analysts reviewed vendor classifications and behavioral tags associated with the file hash. These tags indicated malicious capabilities consistent with unauthorized persistence or command execution, reinforcing need for host remediation.

**Behavioral Significance:**

- Provides insight into attacker capabilities.
- Helps prioritize response actions.

**Detection Guidance:**

- Tag alerts with:
  - malware family context when available

---

### 7) Persistence and Continued Execution Artifacts

This section documents evidence of sustained malicious activity.

#### ▶ 7.1) Artifact: Repeated Execution of Malicious Binary

**Observed Behavior:**

- Same executable launched multiple times over investigation window.

**Where Identified in Investigation:**  
Analysts expanded the time window in Sysmon process telemetry to determine whether execution was isolated or persistent. Multiple process creation events referencing the same file path confirmed repeated execution, suggesting either scheduled tasks, autoruns, or user re-execution of malware.

**Behavioral Significance:**

- Indicates ongoing infection rather than single accidental launch.
- Elevates severity classification.

**Detection Guidance:**

- Alert when:
  - known malicious hashes execute repeatedly
- Correlate with:
  - potential persistence mechanisms

---

### 8) User Session and Context Artifacts

This section documents how execution aligned with user activity.

#### ▶ 8.1) Artifact: Execution Within Interactive User Session

**Observed Behavior:**

- Malware processes executed shortly after user logon events.

**Where Identified in Investigation:**  
Analysts correlated Sysmon process creation times with Windows Security Event ID 4624 to determine whether execution aligned with interactive sessions. This helped determine that execution occurred in user context rather than as background service activity.

**Behavioral Significance:**

- Suggests infection vector may involve user execution or startup triggers.
- Guides persistence hunting focus.

**Detection Guidance:**

- Alert when:
  - malware executes immediately after logon

---

### 9) Absence of Network-Based C2 Artifacts

This section documents negative findings that influenced response scope.

#### ▶ 9.1) Artifact: No Confirmed Command-and-Control Connections

**Observed Behavior:**

- No consistent outbound connections associated with malware process.

**Where Verified in Investigation:**  
Analysts reviewed Sysmon network telemetry and firewall logs associated with the malware process ID to determine whether external communications were occurring. No confirmed C2 connections were observed during the captured timeframe.

**Detection Implications:**

- Limits observed attacker activity to host-level execution.
- Does not eliminate need for full remediation.

---

### 10) Cross-Source Correlation Opportunities

This section outlines detection strategies based on investigation pivots.

#### ▶ 10.1) Correlation 1: File Creation → Process Execution

**Signals:**

- Sysmon Event ID 11
- Sysmon Event ID 1

**Use Case:**  
Detect payload staging immediately followed by execution.


#### ▶ 10.2) Correlation 2: Suspicious Execution → Malicious Hash Match

**Signals:**

- Endpoint execution telemetry
- Threat intelligence enrichment

**Use Case:**  
Automate malware validation and escalation.


#### ▶ 10.3) Correlation 3: Malware Execution → Repeated Launches

**Signals:**

- Repeated Sysmon Event ID 1 entries

**Use Case:**  
Detect persistence or reinfection behavior.

---

### 11) Indicator Reliability Considerations

This section distinguishes between fragile indicators and reliable behaviors.

**Low reliability indicators:**

- File names
- Directory paths

**Higher reliability indicators:**

- Execution shortly after file creation
- Repeated execution of known malicious hashes
- Correlation of execution with user logon events

Behavior-based detection remains effective even when attackers rename payloads.

---

### 12) Closing Summary

This investigation demonstrated how malware validation requires correlation of:

- endpoint execution telemetry,
- file creation activity,
- external threat intelligence,
- and user session context.

By pivoting systematically from suspicious execution to file origin and reputation validation, analysts were able to confidently classify the activity as malware and initiate appropriate response actions.

Detection strategies that combine **endpoint behavior with automated threat intelligence enrichment** can significantly reduce investigation time and improve confidence in malware detections.

