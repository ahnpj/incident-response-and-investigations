# Windows Endpoint Malware Triage Investigation (Living-Off-the-Land Binary (LoLBin) Abuse and Payload Validation)

**Category:** Endpoint Compromise and Persistence  
**Primary Attack Surface:** System binaries and host persistence mechanisms  
**Tactics Observed:** Execution, Defense Evasion, Persistence, Command and Control  
**Primary Data Sources:** Windows Event Logs, File System Artifacts, Scheduled Task Records, Registry Startup Entries, VirusTotal Intelligence

This investigation analyzes suspicious activity on a Windows endpoint where multiple executables masquerading as legitimate software were identified and validated as malicious using only native PowerShell tooling.

The analysis focuses on rapid endpoint triage, artifact validation, and persistence discovery without relying on third-party security tools or graphical forensic utilities. The objective is to determine whether the endpoint is compromised, what actions occurred after execution, and whether the attacker established continued access.

The investigation demonstrates how an analyst:

- Identifies suspicious executables using file system enumeration
- Validates malware using hash, metadata, and signature analysis
- Detects unauthorized account creation and privilege escalation
- Identifies scheduled task and registry-based persistence
- Performs safe analysis without executing unknown binaries

---

## What This Investigation Covers

This case simulates live-response triage on a Windows endpoint under constrained conditions where PowerShell is the only available investigative tool.

The investigation walks through how the analyst:

- Enumerates suspicious executables clustered in a single staging directory
- Identifies masquerading through misleading version metadata
- Confirms malware using hash-based reputation checks
- Detects unsigned MSI installers used as payload delivery mechanisms
- Identifies unauthorized user creation after execution
- Confirms administrative privilege escalation
- Detects persistence via scheduled tasks and registry Run keys
- Identifies abuse of legitimate Windows binaries for startup execution

Rather than performing malware reverse engineering, the walkthrough emphasizes **defender-visible host artifacts** that confirm compromise.

---

## Environment, Data Sources, and Tools

This investigation performs endpoint malware triage and validation using native Windows telemetry, manual artifact inspection, and external threat intelligence to assess execution, privilege escalation, and persistence behaviors following suspected malware infection.

### At-a-Glance Summary

| Area | Details |
|------|---------|
| **Environment Type** | Windows endpoint (malware validation + triage) |
| **Affected Assets** | Suspicious executables; LOLBin-assisted execution; persistence-related configuration on host |
| **Primary Platforms / Services** | Windows endpoint logging/configuration services; local file system + Authenticode; external threat intelligence platforms |
| **Telemetry Sources Reviewed** | File system artifacts + metadata; Authenticode digital signature details; scheduled task configuration; registry startup entries; local user/group configuration |
| **Evidence Types** | Hash/signature trust signals; persistence mechanisms (tasks/registry); host configuration artifacts supporting triage decisions |
| **Tools Used** | PowerShell (hashing, signature checks, artifact inspection); VirusTotal (reputation + enrichment); file hashing utilities; built-in Windows admin tooling (tasks/registry/users) |
| **Investigation Focus** | Validate suspicious payloads and persistence using LOLBin context + signature/reputation + host configuration artifacts |

### Operating Systems

- **Affected System (Victim Environment):**  
  Windows workstation where multiple suspicious executables and persistence mechanisms were observed.

- **Analyst Environment:**  
  Windows-based analyst workstation used for live-response style validation, artifact inspection, and threat intelligence lookups.

### Platforms and Services

- **Windows Endpoint Logging and Configuration Services**  
  Generated process execution telemetry, user account data, scheduled task configuration, and registry startup information used to validate malware behavior.

- **Local File System and Authenticode Services**  
  Provided file metadata and digital signature validation to assess executable legitimacy.

- **External Threat Intelligence Platforms**  
  Used to validate file hashes and determine whether observed executables were known malware.

### Data Sources Reviewed

- **File System Artifacts and Metadata**  
  Reviewed to identify:
  - Suspicious executables
  - File paths and creation timestamps
  - Masquerading filenames and directories

- **Digital Signature Information (Authenticode)**  
  Examined to determine:
  - Whether binaries were signed
  - Whether signatures were valid or spoofed

- **Scheduled Task Configuration**  
  Reviewed to identify:
  - Persistence mechanisms created by malware
  - Execution triggers tied to system startup or user logon

- **Registry Startup Entries**  
  Examined to validate:
  - Autorun persistence using trusted system binaries

- **Local User and Group Configuration**  
  Reviewed to confirm:
  - Unauthorized account creation
  - Privilege escalation behavior

### Tools and Analysis Techniques

- **PowerShell**  
  Used to:
  - Enumerate scheduled tasks
  - Query registry autorun locations
  - Validate file hashes and digital signatures
  - Inspect local user and group membership

- **VirusTotal**  
  Used to:
  - Submit file hashes
  - Validate malware detection rates
  - Identify malware families associated with observed binaries

- **File Hashing Utilities**  
  Used to generate cryptographic hashes for threat intelligence correlation.

- **Built-In Windows Administrative Tools**  
  Used to manually validate:
  - Startup configuration
  - User privileges
  - System persistence mechanisms

This investigation reflects real-world malware triage workflows where analysts must validate execution, persistence, and maliciousness using limited endpoint telemetry and external intelligence rather than full forensic tooling.

---

## Repository Structure & Supporting Documents

### `investigation-walkthrough.md`

Provides a detailed endpoint triage narrative performed entirely using native PowerShell tooling to simulate constrained incident response conditions.

The walkthrough documents:

- Host orientation and environment validation  
- File system enumeration to identify suspicious artifacts  
- Hash and metadata validation of executables and installers  
- Digital signature verification of MSI packages  
- Behavioral analysis of executable impact on users and groups  
- Identification of scheduled task and registry persistence mechanisms  

Each step explains how native operating system tooling can be used to confirm compromise, identify privilege escalation, and detect persistence without third-party forensic tools.


### `images`

Contains screenshots supporting each stage of endpoint analysis, including:

- File discovery and validation  
- Account and group modifications  
- Persistence mechanism identification  

These visuals demonstrate how conclusions were derived directly from host artifacts.

### `case-report.md`

Provides the primary technical record of the malware investigation, documenting artifact discovery, validation steps, and confirmation of compromise.

Summarizes:

- Investigation scope  
- Evidence reviewed  
- Host and account impact  
- Final incident determination  

Written in a format consistent with endpoint incident case tracking and escalation workflows.

### `detection-artifact-report.md`

Documents host-based indicators and behavioral patterns suitable for endpoint detection and SIEM correlation.

Includes artifacts relevant to:

- Malware execution from user-writable directories  
- Privilege escalation events  
- Scheduled task and registry persistence mechanisms  

Supports development of behavioral detections and threat hunting workflows for endpoint environments.

### `incident-response-report.md`

Focuses on response actions required to contain the malware, remove persistence mechanisms, and restore endpoint security posture.

Includes:

- Host isolation considerations  
- Account and privilege remediation  
- Persistence removal steps  
- Validation of cleanup actions  

Reflects how security teams document containment and recovery actions following endpoint compromise.

### `incident-summary.md`

Provides a concise overview of the malware infection and its operational impact, written for stakeholders who require awareness of compromise and remediation scope without technical analysis details.

Intended for:

- Management  
- IT operations  
- Compliance and audit teams  

Summarizes infection method, privilege escalation, persistence mechanisms, and immediate risks to the affected endpoint.

### `detection-and-hardening-recommendations.md`

Focuses on endpoint protection improvements and configuration controls identified during analysis of malware execution and persistence on the host.

Includes recommendations covering:

- Application control policies to block execution from user-writable directories  
- Improved malware prevention and tamper protection settings  
- Restrictions on unauthorized local account creation and privilege escalation  
- Monitoring and alerting for scheduled task and registry autorun persistence  
- PowerShell logging and command-line auditing enhancements  

This file reflects how endpoint security and IT teams document hardening actions and detection improvements following confirmed malware infections.

### `MITRE-ATT&CK-mapping.md`

Maps observed endpoint behaviors to MITRE ATT&CK tactics and techniques using file system, account, and persistence artifacts collected during analysis of the infected host.

Includes:

- MITRE ATT&CK tactics and techniques  
- Supporting host-based evidence from this investigation  

Both narrative explanations and a table view are provided to support standardized reporting and alignment with endpoint detection frameworks.

---

## Intended Use

This investigation demonstrates host-based compromise validation using only native Windows tooling. It emphasizes how defenders can confirm compromise, identify persistence, and prioritize remediation without advanced forensic utilities.

---

## Relevance to Security Operations

Attackers frequently rely on trusted Windows utilities and user-accessible directories to evade detection.

This investigation demonstrates how defenders can:

- Detect masquerading binaries
- Identify post-execution privilege changes
- Discover persistence using built-in OS telemetry

Correlating these artifacts enables rapid containment and recovery during endpoint incidents.

---

If you are reviewing this as part of my cybersecurity portfolio: this investigation demonstrates practical endpoint triage, persistence detection, and evidence-based incident confirmation using native operating system tools.