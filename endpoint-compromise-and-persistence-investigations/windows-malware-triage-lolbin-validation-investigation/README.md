# Windows Endpoint Malware Triage Investigation (Living-Off-the-Land Binary Abuse and Payload Validation)

**Category:** Endpoint Compromise and Persistence  
**Primary Attack Surface:** System binaries and host persistence mechanisms  
**Tactics Observed:** Execution, Defense Evasion, Persistence, Command and Control  
**Primary Data Sources:** Windows Event Logs, File System Artifacts, Scheduled Task Records, Registry Startup Entries, VirusTotal Intelligence

---

### Overview

This investigation analyzes suspicious activity on a Windows endpoint where multiple executables masquerading as legitimate software were identified and validated as malicious using only native PowerShell tooling.

The objective is to determine whether the endpoint is compromised, what actions occurred following execution, and whether persistence and privilege escalation were established, without relying on third-party security tools or graphical forensic utilities. The analysis validates payload legitimacy using file metadata, cryptographic hashes, and Authenticode signature checks, correlates post-execution host configuration changes, and confirms persistence through scheduled tasks and registry autorun mechanisms.

> ðŸ‘‰ **Follow the investigation walkthrough first**  
Begin with `investigation-walkthrough.md` inside this investigation folder to see how I identified, pivoted on, and validated evidence step by step.

> ðŸ‘‰ **Review findings and conclusions**  
Move to the `case-report.md` and `incident-summary.md` to understand what happened, what was confirmed, and why it mattered â€” from both technical and high-level perspectives.

> ðŸ‘‰ **Dig into evidence and detections**  
For deeper technical detail, review the `detection-artifact-report.md`, supporting screenshots, and extracted artifacts to see exactly how conclusions were supported by telemetry.

> ðŸ‘‰ **See defensive takeaways**  
Finish with `detection-and-hardening-recommendations.md` and `mitre-attack-mapping.md` to understand how observed attacker behavior maps to MITRE ATT&CK and where detection or control improvements were identified.

> ðŸ‘‰ **Use this repository as case-based learning**  
These investigations are designed to be read like **real SOC case files**, showing not just *what* happened, but *how* an analyst reasoned through the incident using multiple data sources.

---

### What This Investigation Covers

This case simulates live-response triage on a Windows endpoint under constrained conditions where PowerShell is the primary available investigative tool.

The investigation enumerates suspicious executables clustered within a staging directory, identifies masquerading through misleading version metadata, confirms malware using hash-based reputation checks, detects unsigned MSI installers used as payload delivery mechanisms, confirms unauthorized account creation and administrative privilege escalation, and identifies persistence through scheduled tasks and registry Run keys. It also confirms abuse of legitimate Windows binaries to support startup execution and defense evasion.

Rather than performing reverse engineering, the walkthrough emphasizes defender-visible host artifacts that confirm compromise, persistence, and post-execution impact.

---

### How to Navigate This Investigation

This case is documented across multiple focused reports to reflect how endpoint incidents are handled in real SOC and incident response workflows. Supporting reports provide incident summaries, response actions, detection artifacts, and security improvement recommendations. A breakdown of each file is provided below.

If you want to follow the investigation step by step, start with:

**`investigation-walkthrough.md`**

---

### Repository Structure & Supporting Documents

All investigation outputs are separated into focused reports aligned with common incident documentation practices.

| File / Folder | Purpose | Contents and Focus |
|-------------|--------|--------------------|
| `investigation-walkthrough.md` | Detailed endpoint triage narrative performed entirely using native PowerShell tooling to simulate constrained incident response conditions. | Documents host orientation and environment validation, file system enumeration to identify suspicious artifacts, hash and metadata validation of executables and installers, digital signature verification of MSI packages, behavioral analysis of user and group impact, and identification of scheduled task and registry persistence mechanisms. Explains how native tooling can confirm compromise and persistence without third-party forensic utilities. |
| `images/` | Visual evidence supporting each stage of endpoint analysis. | Contains screenshots showing file discovery and validation, account and group modifications, and persistence mechanism identification that support technical conclusions. |
| `case-report.md` | Primary technical record of the malware investigation aligned with endpoint incident case documentation formats. | Summarizes investigation scope, evidence reviewed, host and account impact, and final incident determination for tracking, escalation, and post-incident review. |
| `detection-artifact-report.md` | Host-based indicators and behavioral patterns suitable for endpoint detection and SIEM correlation. | Documents malware execution from user-writable directories, privilege escalation events, and scheduled task and registry persistence mechanisms to support detection engineering and threat hunting workflows. |
| `incident-response-report.md` | Operational actions required to contain malware, remove persistence, and restore endpoint security posture. | Covers host isolation considerations, account and privilege remediation, persistence removal steps, and validation of cleanup actions following endpoint compromise. |
| `incident-summary.md` | Executive-level overview of malware infection and operational impact. | Summarizes infection method, privilege escalation, persistence mechanisms, and immediate risks to the affected endpoint for management, IT operations, and compliance stakeholders. |
| `detection-and-hardening-recommendations.md` | Endpoint protection improvements and configuration controls identified during malware analysis. | Includes recommendations covering application control to block execution from user-writable directories, improved malware prevention and tamper protection settings, restrictions on unauthorized account creation and privilege escalation, monitoring for scheduled task and registry autorun persistence, and PowerShell logging enhancements. |
| `MITRE-ATT&CK-mapping.md` | Behavioral mapping of observed endpoint activity to MITRE ATT&CK tactics and techniques. | Maps file system, account, and persistence behaviors to ATT&CK techniques using host-based evidence, with both narrative explanations and table-based mappings for standardized reporting. |

---

### Environment, Data Sources, and Tools

This investigation performs endpoint malware triage and validation using native Windows telemetry, manual artifact inspection, and external threat intelligence to assess execution, privilege escalation, and persistence behaviors following suspected malware infection.

#### Environment and Investigation Scope (At a Glance)

| Area | Details |
|--------|---------|
| **Environment Type** | Windows endpoint (malware validation and triage case) |
| **Affected Assets** | Suspicious executables, LOLBin-assisted execution paths, persistence-related host configuration |
| **Victim Operating System** | Windows workstation where malware execution and persistence mechanisms were observed |
| **Analyst Operating System** | Windows-based analyst workstation used for live-response validation, artifact inspection, and threat intelligence lookups |
| **Primary Platforms / Services** | Windows endpoint logging and configuration services; local file system and Authenticode services; external threat intelligence platforms |
| **Investigation Focus** | Validate malicious payloads, confirm persistence mechanisms, and assess privilege escalation using native OS tooling and reputation intelligence |

#### Data Sources, Evidence, and Analysis Techniques

| Area | Details |
|--------|---------|
| **Primary Telemetry Sources** | File system artifacts and metadata, Authenticode digital signature information, scheduled task configuration, registry startup entries, and local user and group configuration |
| **File System Artifacts** | File paths, creation timestamps, and masquerading filenames reviewed to identify suspicious executables staged for execution |
| **Digital Signature Validation** | Authenticode checks used to confirm unsigned or spoofed binaries and assess executable legitimacy |
| **Scheduled Task Artifacts** | Task creation and execution triggers reviewed to identify persistence tied to system startup or user logon |
| **Registry Startup Entries** | Autorun registry locations reviewed to validate persistence using trusted system binaries |
| **Identity and Privilege Artifacts** | Local user and group configuration reviewed to confirm unauthorized account creation and administrative privilege escalation |
| **PowerShell Analysis Techniques** | Enumeration of scheduled tasks, registry autorun locations, file hashes, digital signatures, and user/group membership using native command-line tooling |
| **VirusTotal Enrichment** | Hash reputation checks and malware family identification used to validate payload classification |
| **Administrative Tooling** | Built-in Windows utilities used to validate startup configuration, user privileges, and persistence mechanisms |
| **Operational Workflow Context** | Demonstrates malware triage workflows where defenders must validate execution, persistence, and maliciousness using limited host telemetry and external intelligence rather than full forensic tooling |

This investigation reflects real-world malware triage workflows where analysts must confirm compromise and persistence using host artifacts and threat intelligence under constrained response conditions.

---

### Intended Use

This investigation demonstrates endpoint compromise validation using only native Windows tooling. It emphasizes how defenders can confirm malware execution, identify persistence, and prioritize remediation without advanced forensic utilities.

---

### Relevance to Security Operations

Attackers frequently rely on trusted Windows utilities and user-accessible directories to evade detection.

This investigation demonstrates how defenders can detect masquerading binaries, identify post-execution privilege changes, and discover persistence using built-in operating system telemetry. Correlating these artifacts enables rapid containment and recovery during endpoint incidents.

---

If you are reviewing this as part of my cybersecurity portfolio: this investigation demonstrates practical endpoint triage, persistence detection, and evidence-based incident confirmation using native operating system tools.


