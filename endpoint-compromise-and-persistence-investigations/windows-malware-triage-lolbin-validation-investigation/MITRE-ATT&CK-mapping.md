# MITRE ATT&CK Mapping - Windows Endpoint Malware Triage Investigation (Living-Off-the-Land Binary (LoLBin) Abuse and Payload Validation)

This document maps attacker behaviors observed during this investigation to MITRE ATT&CK tactics and techniques using direct evidence from file system artifacts, PowerShell output, local account changes, scheduled task configuration, and registry persistence mechanisms.

All mappings are based on confirmed activity reconstructed during analysis rather than inferred attacker intent or assumed tooling.

The purpose of this mapping is to support standardized incident classification, detection coverage validation, and alignment with threat modeling frameworks commonly used by security operations teams.

---

### How This Mapping Was Performed

Techniques were mapped by reviewing:

- File discovery and hashing results for suspicious executables
- Authenticode signature validation of installer artifacts
- Local user and group membership changes after execution
- Scheduled task configuration and execution parameters
- Registry Run key persistence entries created post-execution

Each technique below references the investigative pivots and artifacts that supported classification.

---

### MITRE ATT&CK Mapping (Narrative View)

### (1) Execution

#### User Execution (T1204)

**Observed Behavior:**  
Malicious executables were launched directly by the user, including `Win_Update.exe`, which triggered post-execution system changes. The investigation confirmed that execution occurred after manual interaction with downloaded or staged files rather than through service-based or exploit-driven execution.

**Why This Maps to ATT&CK:**  
ATT&CK defines User Execution as reliance on user-initiated execution of malicious payloads, which aligns with the observed infection chain.

**Evidence Sources and Attribution:**  
| Field | Value | Investigative Use |
|--------|--------|------------------|
| Executed File | `Win_Update.exe` | Identifies user-launched malicious executable |
| Host State Changes | Account creation and persistence observed post-execution | Correlates execution with follow-on compromise activity |


### (2) Defense Evasion

#### Masquerading (T1036)

**Observed Behavior:**  
The executable `omgsoft.exe` presented metadata claiming to be “CCleaner Browser Setup,” despite being identified as Lumma Stealer during reputation validation. Filename and version metadata were inconsistent with legitimate software distribution and were used to disguise malicious intent.

**Why This Maps to ATT&CK:**  
Masquerading includes use of deceptive filenames and metadata to appear legitimate, which was directly observed in this artifact.

**Evidence Sources and Attribution:**
| Field | Value | Investigative Use |
|--------|--------|------------------|
| File Name | `omgsoft.exe` | Identifies masquerading executable |
| File Metadata | Claims to be “CCleaner Browser Setup” | Demonstrates deceptive branding |
| Reputation Results | Identified as Lumma Stealer via VirusTotal | Confirms malicious classification |
| Metadata Mismatch | Filename and version inconsistent with behavior | Supports masquerading assessment |


### (3) Persistence (Scheduled Task)

#### Scheduled Task/Job: Scheduled Task (T1053.005)

**Observed Behavior:**  
A scheduled task named `LoginProcessDump` was created to execute PowerShell with hidden window settings on user logon. The task executed PowerShell with `-NoProfile` and `-WindowStyle Hidden`, dumping process information to `C:\processes.txt`.

**Why This Maps to ATT&CK:**  
ATT&CK defines scheduled tasks as a common persistence mechanism, especially when used to trigger script execution during user logon events.

**Evidence Sources and Attribution:**
| Field | Value | Investigative Use |
|--------|--------|------------------|
| Scheduled Task Name | `LoginProcessDump` | Identifies persistence mechanism |
| Task Action | PowerShell execution | Confirms script-based persistence |
| Execution Flags | `-NoProfile -WindowStyle Hidden` | Indicates stealth execution |
| Output File | `C:\processes.txt` | Confirms post-execution activity |


### (4) Persistence (Registry Autorun)

#### Registry Run Keys / Startup Folder (T1547.001)

**Observed Behavior:**  
A registry Run key value named `MaliciousApp` was created under: `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`. The value pointed to `notepad.exe`, indicating use of a living-off-the-land binary (LOLBIN) for persistence.

**Why This Maps to ATT&CK:**  
ATT&CK defines Run key modification as a persistence mechanism used to execute programs at user logon, including use of trusted binaries.

**Evidence Sources and Attribution:**
| Field | Value | Investigative Use |
|--------|--------|------------------|
| Registry Key | `HKCU\Software\Microsoft\Windows\CurrentVersion\Run` | Confirms persistence location |
| Value Name | `MaliciousApp` | Identifies attacker-created autorun entry |
| Executable Path | `notepad.exe` | Indicates LOLBin abuse |


### (5) Privilege Escalation

#### Create Account: Local Account (T1136.001)

**Observed Behavior:**  
A new local account named `testuser` was created after execution of malicious artifacts and added to the local Administrators group. This was identified during enumeration of local users and group membership following execution of `Win_Update.exe`.

**Why This Maps to ATT&CK:**  
Creation of unauthorized local accounts to maintain elevated access is explicitly documented as an ATT&CK persistence and privilege escalation technique.

**Evidence Sources and Attribution:**
| Field | Value | Investigative Use |
|--------|--------|------------------|
| New Account | `testuser` | Identifies unauthorized account creation |
| Group Membership | Added to Administrators | Confirms elevated privileges |
| Timing Correlation | Post-execution of `Win_Update.exe` | Links account creation to malware execution |


### (6) Credential Access / Collection

#### Input Capture / Process Discovery (Supporting Behavior)

**Observed Behavior:**  
The scheduled task executed PowerShell to dump process information to `C:\processes.txt`, indicating reconnaissance or data collection behavior post-compromise. While not direct credential harvesting, this activity reflects host discovery and preparation for follow-on actions.

**Why This Is Not Fully Mapped:**  
No direct credential harvesting mechanisms were observed. This behavior is noted as supporting reconnaissance rather than mapped to a primary credential access technique.

**Evidence Sources and Attribution:**
| Field | Value | Investigative Use |
|--------|--------|------------------|
| Scheduled Task Command | PowerShell dumping process data | Indicates host discovery |
| Output File | `C:\processes.txt` | Confirms data collection artifact |

---

### MITRE ATT&CK Mapping (Table View)

| Tactic | Technique ID | Technique Name | Evidence Summary | Evidence Source |
|--------|--------------|----------------|------------------|-----------------|
| Execution | T1204 | User Execution | `Win_Update.exe` manually executed leading to system changes | File execution + host state changes |
| Defense Evasion | T1036 | Masquerading | `omgsoft.exe` claimed to be CCleaner but identified as Lumma Stealer | File metadata, VirusTotal |
| Persistence | T1053.005 | Scheduled Task | `LoginProcessDump` task running hidden PowerShell at logon | Task configuration |
| Persistence | T1547.001 | Registry Run Keys | `MaliciousApp` Run key executing `notepad.exe` | Registry Run key |
| Privilege Escalation | T1136.001 | Create Local Account | Unauthorized admin account `testuser` created | Local users/groups |

This table provides a condensed reference suitable for reporting, detection validation, and technique tracking across multiple investigations.

---

### Detection and Control Relevance

Mapping behaviors to MITRE ATT&CK supports defensive operations by:

- Highlighting detection opportunities for scheduled task creation  
- Supporting monitoring of registry Run key modifications  
- Reinforcing alerting on unsigned installer execution  
- Identifying abnormal local account creation and privilege escalation  

Detection opportunities and preventive control recommendations associated with these techniques are documented in:

- `detection-artifact-report.md`  
- `detection-and-hardening-recommendations.md`

---

### Notes and Assumptions

- All techniques are mapped solely based on behaviors confirmed during post-execution host inspection.
- No exploit-based initial access or network-based command-and-control was observed within scope.
- Mapping avoids attribution to malware families beyond confirmed artifact identification.

This mapping reflects how ATT&CK is commonly applied during endpoint malware triage and validation workflows focused on host-based evidence.

